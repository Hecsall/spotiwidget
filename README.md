# Spotify Widget

"Currently Playing" SVG Spotify Widget.

> This project used to be a fork of [https://github.com/kittinan/spotify-github-profile](https://github.com/kittinan/spotify-github-profile) but since a lot of python code changed, I decided to start a separate repo for it.

## **Usage**
<a href="https://spotiwidget.vercel.app/" target="_blank" title="Open SpotiWidget">
    <svg width="177" height="50" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="177" height="50" rx="25" fill="#1ED760"/><path d="M60.654 24.303v.606c0 .973-.132 1.846-.395 2.62-.264.773-.636 1.432-1.116 1.977a4.84 4.84 0 0 1-1.723 1.24c-.662.286-1.398.43-2.206.43a5.529 5.529 0 0 1-2.206-.43 4.944 4.944 0 0 1-1.723-1.24c-.486-.545-.864-1.204-1.134-1.978-.263-.773-.395-1.646-.395-2.619v-.606c0-.979.132-1.852.395-2.62.264-.773.636-1.432 1.117-1.977a4.893 4.893 0 0 1 1.722-1.248 5.53 5.53 0 0 1 2.206-.43c.809 0 1.544.143 2.206.43a4.79 4.79 0 0 1 1.723 1.248c.486.545.861 1.204 1.125 1.978.27.767.404 1.64.404 2.619Zm-2.663.606v-.624c0-.68-.061-1.277-.184-1.793-.123-.515-.305-.949-.545-1.3a2.352 2.352 0 0 0-.88-.792 2.513 2.513 0 0 0-1.186-.272c-.445 0-.84.09-1.186.272-.34.176-.63.44-.87.791-.235.352-.413.786-.537 1.301-.123.516-.184 1.113-.184 1.793v.624c0 .674.062 1.272.184 1.793.124.516.305.952.545 1.31.24.351.534.618.88.8.345.181.74.272 1.186.272.445 0 .84-.09 1.186-.273.346-.181.636-.448.87-.8.235-.357.414-.793.537-1.309.123-.521.184-1.119.184-1.793Zm6.935-1.59v11.337h-2.532V21.49h2.347l.185 1.828Zm6.02 2.82v.185c0 .692-.082 1.333-.246 1.925a4.805 4.805 0 0 1-.703 1.547 3.34 3.34 0 0 1-1.16 1.02c-.457.24-.984.36-1.582.36-.58 0-1.084-.117-1.512-.352a3.149 3.149 0 0 1-1.08-.984 5.697 5.697 0 0 1-.695-1.485 11.715 11.715 0 0 1-.405-1.811v-.483c.094-.692.229-1.325.405-1.899.176-.58.407-1.08.694-1.503.293-.428.65-.759 1.072-.993.428-.234.93-.352 1.503-.352.604 0 1.134.115 1.591.343.463.229.85.557 1.16.985.317.427.554.937.712 1.529a7.36 7.36 0 0 1 .246 1.969Zm-2.54.185v-.184c0-.405-.035-.777-.105-1.117a2.895 2.895 0 0 0-.317-.905 1.539 1.539 0 0 0-.562-.598c-.229-.146-.507-.22-.835-.22-.346 0-.642.056-.888.168-.24.111-.436.272-.589.483a2.24 2.24 0 0 0-.342.756 4.877 4.877 0 0 0-.141.993v1.222c.03.433.111.823.246 1.169.135.34.343.61.624.808.281.2.65.3 1.108.3.334 0 .615-.074.843-.22.229-.153.413-.36.554-.624.146-.264.249-.569.308-.915.064-.345.096-.717.096-1.116Zm8.49 4.852c-.738 0-1.4-.117-1.986-.352a4.362 4.362 0 0 1-1.494-.993 4.414 4.414 0 0 1-.932-1.468 4.942 4.942 0 0 1-.325-1.793v-.351c0-.721.103-1.38.308-1.978a4.652 4.652 0 0 1 .879-1.555c.386-.44.855-.777 1.406-1.011.55-.24 1.172-.36 1.863-.36.674 0 1.272.11 1.793.333.522.223.958.54 1.31.95.357.41.627.902.808 1.476.182.569.273 1.201.273 1.899v1.054H73.24V25.34h5.072v-.194c0-.351-.065-.665-.194-.94a1.493 1.493 0 0 0-.562-.668c-.252-.164-.575-.246-.967-.246-.334 0-.621.073-.861.22-.24.146-.437.351-.59.615a3.348 3.348 0 0 0-.333.932c-.07.351-.106.738-.106 1.16v.351c0 .381.053.733.158 1.055.112.322.267.6.466.835.205.234.451.416.739.545.293.129.624.193.993.193.457 0 .881-.088 1.274-.263a2.76 2.76 0 0 0 1.028-.818l1.23 1.336c-.198.287-.47.563-.817.826-.34.264-.75.48-1.23.65-.48.165-1.028.247-1.644.247Zm7.823-7.655V31h-2.531v-9.51h2.373l.158 2.03Zm-.37 2.39h-.685c0-.703.09-1.336.272-1.898a4.323 4.323 0 0 1 .765-1.45 3.285 3.285 0 0 1 1.17-.923 3.525 3.525 0 0 1 1.528-.326c.446 0 .853.065 1.222.194.37.129.686.334.95.615.269.281.474.653.615 1.116.146.463.22 1.029.22 1.697V31h-2.55v-6.073c0-.422-.058-.75-.175-.985a.987.987 0 0 0-.519-.492c-.223-.1-.498-.15-.826-.15-.34 0-.636.068-.888.203a1.765 1.765 0 0 0-.615.562c-.158.235-.278.51-.36.827a4.048 4.048 0 0 0-.123 1.02Zm17.122-4.42v1.792h-5.537V21.49h5.537Zm-4.166-2.347h2.53v8.99c0 .276.036.487.106.634a.635.635 0 0 0 .334.307c.147.053.331.08.554.08.158 0 .299-.007.422-.018a5.46 5.46 0 0 0 .325-.053l.009 1.863c-.217.07-.451.126-.703.167-.252.041-.53.062-.835.062-.557 0-1.043-.091-1.46-.273a2.009 2.009 0 0 1-.948-.896c-.223-.41-.334-.95-.334-1.617v-9.246Zm8.077-1.644V31h-2.531V17.5h2.531Zm-.361 8.411h-.694a6.437 6.437 0 0 1 .264-1.828c.17-.563.413-1.049.729-1.459a3.378 3.378 0 0 1 1.134-.967 3.187 3.187 0 0 1 1.477-.343c.468 0 .893.068 1.274.203.387.128.718.34.993.632.281.287.498.665.651 1.134.152.469.228 1.037.228 1.705V31h-2.549v-6.03c0-.421-.061-.752-.184-.992a1.015 1.015 0 0 0-.519-.519c-.222-.105-.498-.158-.826-.158-.363 0-.674.067-.932.202a1.596 1.596 0 0 0-.606.562c-.152.235-.264.51-.334.827-.07.316-.106.656-.106 1.02Zm12.358 5.265c-.738 0-1.4-.117-1.986-.352a4.373 4.373 0 0 1-1.495-.993 4.42 4.42 0 0 1-.931-1.468 4.938 4.938 0 0 1-.325-1.793v-.351c0-.721.102-1.38.307-1.978a4.648 4.648 0 0 1 .879-1.555 3.87 3.87 0 0 1 1.406-1.011c.551-.24 1.172-.36 1.864-.36.673 0 1.271.11 1.793.333.521.223.958.54 1.309.95.358.41.627.902.809 1.476.181.569.272 1.201.272 1.899v1.054h-7.558V25.34h5.071v-.194c0-.351-.065-.665-.193-.94a1.493 1.493 0 0 0-.563-.668c-.252-.164-.574-.246-.967-.246-.334 0-.621.073-.861.22-.24.146-.437.351-.589.615a3.357 3.357 0 0 0-.334.932c-.07.351-.105.738-.105 1.16v.351c0 .381.052.733.158 1.055.111.322.266.6.466.835.205.234.451.416.738.545.293.129.624.193.993.193.457 0 .882-.088 1.275-.263a2.761 2.761 0 0 0 1.028-.818l1.23 1.336a3.731 3.731 0 0 1-.817.826c-.34.264-.75.48-1.231.65-.48.165-1.028.247-1.643.247Zm14.959-2.32v-4.237c0-.305-.05-.565-.15-.782a1.107 1.107 0 0 0-.465-.519c-.205-.123-.472-.184-.8-.184-.281 0-.525.05-.73.15a1.053 1.053 0 0 0-.474.412 1.136 1.136 0 0 0-.167.624h-2.531c0-.404.093-.788.281-1.151a2.87 2.87 0 0 1 .817-.958c.358-.281.782-.501 1.275-.66a5.496 5.496 0 0 1 1.669-.236c.739 0 1.395.122 1.969.369a3.01 3.01 0 0 1 1.354 1.107c.334.492.501 1.107.501 1.846v4.07c0 .52.032.948.096 1.282.065.328.159.616.282.862V31h-2.558a3.642 3.642 0 0 1-.281-.967 7.914 7.914 0 0 1-.088-1.178Zm.334-3.648.017 1.433h-1.415c-.334 0-.624.038-.87.114a1.617 1.617 0 0 0-.606.325 1.257 1.257 0 0 0-.352.475c-.07.181-.105.38-.105.597 0 .217.05.413.149.59.1.17.243.304.431.403.187.094.407.141.659.141.381 0 .712-.076.993-.228.281-.153.498-.34.651-.563.158-.223.24-.434.246-.633l.668 1.073c-.094.24-.223.489-.387.747a3.48 3.48 0 0 1-.606.73 3.136 3.136 0 0 1-.888.553c-.346.14-.756.21-1.231.21-.603 0-1.151-.12-1.643-.36a2.99 2.99 0 0 1-1.16-1.01 2.648 2.648 0 0 1-.422-1.477c0-.498.094-.94.281-1.327.188-.387.463-.712.826-.976.369-.27.829-.471 1.38-.606.551-.14 1.19-.211 1.916-.211h1.468Zm6.697-1.89v11.338h-2.531V21.49h2.347l.184 1.828Zm6.021 2.822v.184c0 .692-.082 1.333-.246 1.925a4.812 4.812 0 0 1-.704 1.547c-.31.434-.697.773-1.16 1.02-.457.24-.984.36-1.582.36-.58 0-1.084-.117-1.511-.352a3.15 3.15 0 0 1-1.082-.984 5.707 5.707 0 0 1-.694-1.485 11.727 11.727 0 0 1-.404-1.811v-.483c.094-.692.228-1.325.404-1.899.176-.58.407-1.08.694-1.503a3.146 3.146 0 0 1 1.073-.993c.427-.234.928-.352 1.503-.352.603 0 1.133.115 1.59.343.463.229.85.557 1.161.985.316.427.553.937.712 1.529.164.592.246 1.248.246 1.969Zm-2.54.184v-.184c0-.405-.036-.777-.106-1.117a2.895 2.895 0 0 0-.316-.905 1.538 1.538 0 0 0-.563-.598c-.228-.146-.507-.22-.835-.22a2.14 2.14 0 0 0-.887.168 1.474 1.474 0 0 0-.589.483c-.153.211-.267.463-.343.756a4.925 4.925 0 0 0-.141.993v1.222c.03.433.112.823.246 1.169.135.34.343.61.624.808.282.2.651.3 1.108.3.334 0 .615-.074.844-.22.228-.153.413-.36.553-.624.147-.264.249-.569.308-.915a6.13 6.13 0 0 0 .097-1.116Zm6.644-3.006v11.338h-2.531V21.49h2.347l.184 1.828Zm6.021 2.822v.184c0 .692-.082 1.333-.246 1.925a4.812 4.812 0 0 1-.704 1.547c-.31.434-.697.773-1.16 1.02-.457.24-.984.36-1.582.36-.58 0-1.084-.117-1.511-.352a3.15 3.15 0 0 1-1.082-.984 5.707 5.707 0 0 1-.694-1.485 11.727 11.727 0 0 1-.404-1.811v-.483c.094-.692.228-1.325.404-1.899.176-.58.407-1.08.694-1.503a3.146 3.146 0 0 1 1.073-.993c.427-.234.928-.352 1.503-.352.603 0 1.133.115 1.59.343.463.229.85.557 1.161.985.316.427.553.937.712 1.529.164.592.246 1.248.246 1.969Zm-2.54.184v-.184c0-.405-.036-.777-.106-1.117a2.895 2.895 0 0 0-.316-.905 1.538 1.538 0 0 0-.563-.598c-.228-.146-.507-.22-.835-.22a2.14 2.14 0 0 0-.887.168 1.474 1.474 0 0 0-.589.483c-.153.211-.267.463-.343.756a4.925 4.925 0 0 0-.141.993v1.222c.03.433.112.823.246 1.169.135.34.343.61.624.808.282.2.651.3 1.108.3.334 0 .615-.074.844-.22.228-.153.413-.36.553-.624.147-.264.249-.569.308-.915a6.13 6.13 0 0 0 .097-1.116ZM30 16l9.526 16.5H20.474L30 16Z" fill="#121212"/></svg>
</a>

1. Click the "Open the app" button or go to https://spotiwidget.vercel.app/
2. Login with your Spotify Account
3. Customize your widget as you like
4. Copy the generated code at the bottom of the page and place it in any Markdown file
5. Enjoy!

## **Local development setup**
Create a Python virtualenvironment and install dependencies
> Tested with Python 3.9
```sh
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

Copy the `.env.example` file and name it `.env`, then populate it with the correct environment variables.
> `.env` file already git-ignored
- **FLASK_SECRET_KEY**: Random long string
- **SPOTIFY_CLIENT_ID**: Client ID from your spotify app (https://developer.spotify.com/dashboard/applications)
- **SPOTIFY_CLIENT_SECRET**: Client Secret from your spotify app (https://developer.spotify.com/dashboard/applications)
- **BASE_URL**: Base URL of your app, http://localhost:5000 for local development.
- **FIREBASE**: Base64 encode your Firebase credentials JSON file content and paste it here.

> Suggestion: on Spotify Developer, as "Redirect URIs" place what will be your app url (https://something.vercel.app/) along with "http://localhost:5000/", so that you will be able to login while testing locally.

Run the local development server
```sh
python index.py
```

## **Notable changes**
> :magic_wand: &rarr; Uses an internal script tag to handle dynamic changes. These scripts won't start on GitHub, but the rest of the widget will be displayed normally. 
- :magic_wand: **Auto refresh**: I added a `<script>` tag inside the SVG that will auto refresh the widget when the song ends.
- :magic_wand: **Song progress**: With the `<script>` of the point above, it's now possible to have a progress bar to show the song progress (almost entirely in CSS).
- **Upgraded dependencies**: Not a big deal, but I bumped all the dependencies versions to the latest available.
- **SCSS styles**: Theme styles in SCSS (compiled when `app.py` runs).

## **TODO**
- Plan how to manage widgets width and height automatically
- Optimize themes visuals (like scrolling titles)
- More customizations parameters
- Spotify Developer Guidelines compliancy
- "OBS-friendly" usage (as browser source)